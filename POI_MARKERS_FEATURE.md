# POI 标记功能说明

## 功能概述

在地图页面新增了以当前经纬度为中心，获取周围较大范围 POI 列表并在地图上以图标形式标记的功能。

## 主要功能

### 1. 自动加载 POI
- 当用户点击定位按钮时，系统会自动获取当前位置
- 定位完成后，自动加载周围 5-15 公里范围内的 POI 数据
- 支持多种类型：美食、景点、娱乐、购物

### 2. 手动加载 POI
- 在 AppBar 中新增"显示周围地点"按钮
- 用户可以随时手动触发 POI 加载
- 显示加载状态指示器

### 3. POI 标记显示
- 在地图上以图标形式显示所有 POI
- 不同类型的 POI 使用不同图标（目前统一使用 logo.jpeg）
- 显示 POI 名称和地址信息

### 4. POI 详情查看
- 点击地图上的 POI 标记可查看详细信息
- 显示评分、距离、分类、价格、营业时间等信息
- 提供导航和分享功能（待开发）

### 5. 统计信息
- 在地图底部显示发现的 POI 数量
- 提供清除标记功能

## 技术实现

### API 调用
- 使用 `/api/baidu-maps/search-places` 接口
- 并发请求多种类型的 POI 数据
- 支持不同搜索半径和数量限制

### 数据去重
- 基于 POI 的 uid 进行去重
- 避免重复显示相同地点

### 地图标记
- 使用百度地图 SDK 的 BMFMarker.icon() 方法
- 支持标记点击事件处理
- 动态添加和清除标记

## 搜索范围配置（已优化）

| POI 类型 | 搜索半径 | 数量限制 | 优先级 |
|---------|---------|---------|--------|
| 美食     | 8公里    | 12个     | 高     |
| 景点     | 12公里   | 8个      | 高     |
| 娱乐     | 6公里    | 6个      | 中     |
| 购物     | 已移除   | -        | -      |

### 优化策略：
- **串行请求**：改为串行请求，避免并发过多
- **请求间隔**：每次请求间隔 800ms，避免过于频繁
- **智能停止**：如果已获取足够 POI（≥5个），跳过其他类型
- **减少数量**：大幅减少每次请求的数量限制

## 使用方法

1. **自动加载**：点击定位按钮，系统会自动加载周围 POI
2. **手动加载**：点击 AppBar 中的"显示周围地点"按钮
3. **查看详情**：点击地图上的 POI 标记
4. **清除标记**：点击底部的"清除标记"按钮

## 注意事项

- 需要网络连接才能获取 POI 数据
- 标记点击事件目前暂时注释，需要确认正确的回调方法名
- 图标资源目前统一使用 logo.jpeg，后续可以优化为不同类型专用图标
- 导航和分享功能目前显示"开发中"提示

## 后续优化建议

1. 为不同类型的 POI 创建专用图标
2. 实现真正的导航功能
3. 添加 POI 筛选功能
4. 优化 POI 加载性能
5. 添加 POI 收藏功能

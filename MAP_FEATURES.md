# 地图功能说明

## 概述

基于百度地图 API 实现的地图功能，提供位置搜索、地点查询、路线规划等功能。

## 功能特性

### 1. 位置服务
- **当前位置显示** - 显示当前坐标和地址信息
- **位置刷新** - 手动刷新位置信息
- **地址解析** - 坐标转地址功能

### 2. 搜索功能
- **关键词搜索** - 支持任意关键词搜索附近地点
- **快速搜索** - 一键搜索美食、景点、酒店
- **搜索结果展示** - 显示地点名称、地址、评分、距离等信息

### 3. 地点详情
- **详细信息** - 显示地点完整信息
- **评分系统** - 显示用户评分
- **距离计算** - 显示到当前位置的距离
- **营业信息** - 显示营业时间和人均消费

### 4. 交互功能
- **地点详情弹窗** - 点击地点查看详细信息
- **导航功能** - 预留导航接口
- **分享功能** - 预留分享接口

## 技术实现

### 1. API 集成
- 使用 Photo Backend API 服务
- 支持百度地图所有核心功能
- 统一的错误处理机制

### 2. 数据模型
- `Location` - 位置坐标模型
- `Place` - 地点信息模型
- `PlaceDetailInfo` - 地点详细信息模型

### 3. 服务架构
- `ApiService` - 统一的 API 调用服务
- `BaiduMapConfig` - 地图配置管理
- 单例模式确保服务唯一性

## 配置说明

### 百度地图 AK
```dart
// lib/config/baidu_map_config.dart
static const String ak = '1aiol9mfe8awlvmR9PRMC5bxgg5G9Wgc';
```

### 默认配置
- 默认中心点：北京天安门 (39.9042, 116.4074)
- 搜索半径：2000米
- 最大搜索结果：20个
- 定位间隔：5秒

## 使用示例

### 1. 搜索附近美食
```dart
final places = await apiService.searchNearbyFood(
  lat: 39.9042,
  lng: 116.4074,
  radius: 2000,
  limit: 10,
);
```

### 2. 获取地址信息
```dart
final address = await apiService.getAddressByLocation(39.9042, 116.4074);
```

### 3. 搜索任意地点
```dart
final places = await apiService.searchPlaces(
  q: '咖啡厅',
  location: '39.9042,116.4074',
  radius: 2000,
);
```

## 界面说明

### 1. 位置信息卡片
- 显示当前坐标
- 显示详细地址
- 支持手动刷新

### 2. 搜索栏
- 支持关键词输入
- 回车键快速搜索
- 搜索按钮确认

### 3. 快速搜索按钮
- 美食搜索
- 景点搜索
- 酒店搜索

### 4. 搜索结果列表
- 地点名称和地址
- 评分和距离信息
- 点击查看详情

### 5. 地点详情弹窗
- 完整地点信息
- 导航和分享按钮
- 营业时间和价格

## 扩展功能

### 1. 实时定位
- 集成设备 GPS 定位
- 自动更新当前位置
- 位置变化监听

### 2. 路线规划
- 驾车路线规划
- 步行路线规划
- 公交路线规划

### 3. 地图显示
- 集成百度地图 SDK
- 实时地图显示
- 标记点显示

### 4. 离线地图
- 地图数据缓存
- 离线搜索功能
- 数据同步机制

## 注意事项

1. **网络权限** - 确保应用有网络访问权限
2. **位置权限** - 需要位置权限才能获取当前位置
3. **API 限制** - 注意百度地图 API 的调用频率限制
4. **错误处理** - 网络异常时的友好提示
5. **数据缓存** - 考虑添加搜索结果缓存机制

## 后续优化

1. **性能优化** - 搜索结果分页加载
2. **用户体验** - 添加加载动画和骨架屏
3. **功能扩展** - 集成更多地图功能
4. **数据同步** - 与后端数据同步机制
